"use strict";
/*
 * Copyright 2021 IBM All Rights Reserved.
 *
 * SPDX-License-Identifier: Apache-2.0
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.ChaincodeEventsBuilder = void 0;
const fabric_protos_1 = require("@hyperledger/fabric-protos");
const chaincodeeventsrequest_1 = require("./chaincodeeventsrequest");
const eventsbuilder_1 = require("./eventsbuilder");
class ChaincodeEventsBuilder {
    #options;
    #eventsBuilder;
    constructor(options) {
        this.#options = options;
        this.#eventsBuilder = new eventsbuilder_1.EventsBuilder(options);
    }
    build() {
        return new chaincodeeventsrequest_1.ChaincodeEventsRequestImpl({
            client: this.#options.client,
            signingIdentity: this.#options.signingIdentity,
            signedRequest: this.#newSignedChaincodeEventsRequestProto(),
        });
    }
    #newChaincodeEventsRequestProto() {
        const result = new fabric_protos_1.gateway.ChaincodeEventsRequest();
        result.setChannelId(this.#options.channelName);
        result.setChaincodeId(this.#options.chaincodeName);
        result.setIdentity(this.#options.signingIdentity.getCreator());
        result.setStartPosition(this.#eventsBuilder.getStartPosition());
        const transactionId = this.#options.checkpoint?.getTransactionId();
        if (transactionId) {
            result.setAfterTransactionId(transactionId);
        }
        return result;
    }
    #newSignedChaincodeEventsRequestProto() {
        const result = new fabric_protos_1.gateway.SignedChaincodeEventsRequest();
        result.setRequest(this.#newChaincodeEventsRequestProto().serializeBinary());
        return result;
    }
}
exports.ChaincodeEventsBuilder = ChaincodeEventsBuilder;
//# sourceMappingURL=chaincodeeventsbuilder.js.map